/opt/homebrew/lib/python3.14/site-packages/webrtcvad.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
============================================================
CTC Draft Head Training
============================================================
Model: mlx-community/whisper-small-mlx
Data: data/multilingual/chinese/data_thchs30/data
Output: checkpoints/ctc_chinese
Epochs: 3
Batch size: 4
Learning rate: 0.0003
Loss function: PyTorch CTC (best quality)
PyTorch available: True
Initial memory: 324 MB
============================================================

MEMORY OPTIMIZATIONS ENABLED:
  - Sequence trimming (only process actual frames, not padded)
  - Aggressive memory cleanup between batches
  - Immediate tensor deletion after use

ENHANCED TRAINING (Phase 1.3) ENABLED:
  - SpecAugment: F=27, T=100
    freq_masks=2, time_masks=2
  - Label smoothing: 0.1
============================================================

1. Loading Whisper model (frozen encoder)...
Fetching 1 files:   0%|          | 0/1 [00:00<?, ?it/s]Fetching 1 files: 100%|██████████| 1/1 [00:00<00:00, 14027.77it/s]
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/multiprocessing/resource_tracker.py:297: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/mp-ld4yxrx5'}
  warnings.warn(
