/opt/homebrew/lib/python3.14/site-packages/webrtcvad.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
======================================================================
RichDecoder v3 Multi-Task Training
======================================================================
Output: checkpoints/rich_decoder_v3_cached
Model: mlx-community/whisper-large-v3-mlx
LoRA: rank=32, alpha=64
Freeze: para=False, language=False
Encoder cache: data/v3_multitask/encoder_cache
Data source: JSON manifests

1. Loading Whisper model...
Fetching 1 files:   0%|          | 0/1 [00:00<?, ?it/s]Fetching 1 files: 100%|██████████| 1/1 [00:00<00:00, 4032.98it/s]
   Encoder: 1280-dim
2. Loading tokenizer...
3. Creating RichDecoder with LoRA rank=32...
   Total parameters: 930.19M
   Trainable parameters: 23.66M
   LoRA adapters: 192
4. Loading emotion data...
   Using manifest files:
     Train: data/v3_multitask/train_manifest.json
     Val: data/v3_multitask/val_manifest.json
Loading manifest from: data/v3_multitask/train_manifest.json
Loaded 19734 samples from manifest
Loading manifest from: data/v3_multitask/val_manifest.json
Loaded 2193 samples from manifest
   Train: 19734, Val: 2193
5a. Loading emotion head from: checkpoints/rich_decoder_v1/best.npz
Loaded trainable parameters from checkpoints/rich_decoder_v1/best.npz

======================================================================
Starting Multi-Task Training
======================================================================
======================================================================
RichDecoder v3 Multi-Task Training
======================================================================
Epochs: 10
Train samples: 19734
Val samples: 2193
Steps per epoch: 4934
LoRA: rank=32, alpha=64
Frozen heads: none
Loss weights: emo=2.0, lang=0.3, para=0.3

Starting epoch 1/10
  Step 50: loss=3.1589 (emo=0.9265) (lan=0.0000) (par=0.4715)
  Step 100: loss=1.8434 (emo=0.0037) (lan=0.0000) (par=0.0957)
  Step 150: loss=1.3821 (emo=0.3787) (lan=0.0000) (par=0.0198)
  Step 200: loss=1.3377 (emo=0.6479) (lan=0.0000) (par=0.0034)
  Step 250: loss=1.3111 (emo=1.5474) (lan=0.0000) (par=0.0035)
  Step 300: loss=1.3075 (emo=0.8340) (lan=0.0000) (par=0.0371)
  Step 350: loss=1.0283 (emo=0.5313) (lan=0.0000) (par=0.0021)
  Step 400: loss=1.2282 (emo=0.2556) (lan=0.0000) (par=0.0262)
  Step 450: loss=0.9944 (emo=0.0742) (lan=0.0000) (par=0.0424)
  Step 500: loss=0.9777 (emo=1.1798) (lan=0.0000) (par=0.0011)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_500.npz
  Step 550: loss=1.0219 (emo=0.5111) (lan=0.0000) (par=0.0016)
  Step 600: loss=1.1976 (emo=0.5459) (lan=0.0000) (par=0.0090)
  Step 650: loss=1.2233 (emo=1.2082) (lan=0.0000) (par=0.0019)
  Step 700: loss=1.1023 (emo=0.5030) (lan=0.0000) (par=0.0010)
  Step 750: loss=0.9252 (emo=0.0590) (lan=0.0000) (par=0.2788)
  Step 800: loss=0.9703 (emo=0.6299) (lan=0.0000) (par=0.0002)
  Step 850: loss=0.8086 (emo=1.1159) (lan=0.0000) (par=0.0066)
  Step 900: loss=0.6620 (emo=0.1291) (lan=0.0000) (par=0.1424)
  Step 950: loss=0.8635 (emo=0.2068) (lan=0.0000) (par=0.0067)
  Step 1000: loss=0.9800 (emo=0.2094) (lan=0.0000) (par=1.3266)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_1000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_1000.npz
  Step 1050: loss=0.8442 (emo=0.6335) (lan=0.0000) (par=0.0014)
  Step 1100: loss=0.9348 (emo=0.2254) (lan=0.0000) (par=0.0106)
  Step 1150: loss=0.8658 (emo=0.6059) (lan=0.0000) (par=0.0119)
  Step 1200: loss=0.8052 (emo=0.1147) (lan=0.0000) (par=0.0007)
  Step 1250: loss=0.7799 (emo=0.2417) (lan=0.0000) (par=0.0992)
  Step 1300: loss=0.7057 (emo=0.6427) (lan=0.0000) (par=0.0013)
  Step 1350: loss=0.9973 (emo=0.0102) (lan=0.0000) (par=0.0064)
  Step 1400: loss=0.7680 (emo=0.3734) (lan=0.0000) (par=0.7488)
  Step 1450: loss=0.8915 (emo=0.1402) (lan=0.0000) (par=0.0007)
  Step 1500: loss=0.9204 (emo=0.0667) (lan=0.0000) (par=0.0022)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_1500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_1500.npz
  Step 1550: loss=0.6455 (emo=0.2237) (lan=0.0000) (par=0.0035)
  Step 1600: loss=0.8085 (emo=0.3596) (lan=0.0000) (par=0.0115)
  Step 1650: loss=0.7504 (emo=0.3326) (lan=0.0000) (par=0.0079)
  Step 1700: loss=0.8380 (emo=0.2812) (lan=0.0000) (par=0.0003)
  Step 1750: loss=0.8991 (emo=0.7217) (lan=0.0000) (par=0.1183)
  Step 1800: loss=0.9929 (emo=0.6660) (lan=0.0000) (par=0.0741)
  Step 1850: loss=0.9069 (emo=0.0037) (lan=0.0000) (par=0.0018)
  Step 1900: loss=0.8200 (emo=0.7537) (lan=0.0000) (par=0.0647)
  Step 1950: loss=0.7840 (emo=0.0001) (lan=0.0000) (par=0.0023)
  Step 2000: loss=0.6517 (emo=0.5305) (lan=0.0000) (par=0.0053)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_2000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_2000.npz
  Step 2050: loss=0.7121 (emo=0.6894) (lan=0.0000) (par=0.0020)
  Step 2100: loss=0.7893 (emo=1.0827) (lan=0.0000) (par=0.0011)
  Step 2150: loss=1.0546 (emo=0.0012) (lan=0.0000) (par=0.0007)
  Step 2200: loss=0.7877 (emo=0.1785) (lan=0.0000) (par=0.0077)
  Step 2250: loss=0.8578 (emo=0.0117) (lan=0.0000) (par=0.0218)
  Step 2300: loss=0.8464 (emo=0.1797) (lan=0.0000) (par=0.0427)
  Step 2350: loss=0.7247 (emo=0.4362) (lan=0.0000) (par=0.0020)
  Step 2400: loss=0.7383 (emo=0.2562) (lan=0.0000) (par=0.0335)
  Step 2450: loss=0.9036 (emo=0.3298) (lan=0.0000) (par=0.0027)
  Step 2500: loss=0.9467 (emo=0.3267) (lan=0.0000) (par=0.0023)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_2500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_2500.npz
  Step 2550: loss=0.7154 (emo=0.1851) (lan=0.0000) (par=0.1186)
  Step 2600: loss=0.5808 (emo=0.0027) (lan=0.0000) (par=0.0006)
  Step 2650: loss=0.6526 (emo=0.1925) (lan=0.0000) (par=0.0020)
  Step 2700: loss=0.6010 (emo=0.0091) (lan=0.0000) (par=0.0006)
  Step 2750: loss=0.7491 (emo=0.4213) (lan=0.0000) (par=0.0002)
  Step 2800: loss=0.7328 (emo=0.0472) (lan=0.0000) (par=0.0004)
  Step 2850: loss=0.6478 (emo=0.0008) (lan=0.0000) (par=0.0009)
  Step 2900: loss=0.8162 (emo=0.1803) (lan=0.0000) (par=0.0007)
  Step 2950: loss=0.6284 (emo=0.0714) (lan=0.0000) (par=0.0011)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 3000: loss=0.5825 (emo=0.2278) (lan=0.0000) (par=0.0015)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_3000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_3000.npz
  Step 3050: loss=0.7279 (emo=0.0540) (lan=0.0000) (par=0.0001)
  Step 3100: loss=0.6067 (emo=0.0031) (lan=0.0000) (par=0.0051)
  Step 3150: loss=0.5352 (emo=0.2957) (lan=0.0000) (par=0.0001)
  Step 3200: loss=0.7852 (emo=0.4376) (lan=0.0000) (par=0.3521)
  Step 3250: loss=0.7446 (emo=0.0865) (lan=0.0000) (par=0.0080)
  Step 3300: loss=0.7208 (emo=0.5519) (lan=0.0000) (par=0.0090)
  Step 3350: loss=0.5191 (emo=0.9155) (lan=0.0000) (par=0.0001)
  Step 3400: loss=0.6666 (emo=0.0001) (lan=0.0000) (par=0.0003)
  Step 3450: loss=0.6669 (emo=0.2427) (lan=0.0000) (par=0.0026)
  Step 3500: loss=0.6240 (emo=0.3058) (lan=0.0000) (par=0.0002)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_3500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_3500.npz
  Step 3550: loss=0.5109 (emo=0.0833) (lan=0.0000) (par=0.0010)
  Step 3600: loss=0.6846 (emo=0.0453) (lan=0.0000) (par=0.0001)
  Step 3650: loss=0.7477 (emo=0.0070) (lan=0.0000) (par=0.0026)
  Step 3700: loss=0.9387 (emo=0.0529) (lan=0.0000) (par=0.0001)
  Step 3750: loss=0.9066 (emo=0.6149) (lan=0.0000) (par=0.0022)
  Step 3800: loss=0.6184 (emo=0.1194) (lan=0.0000) (par=0.0002)
  Step 3850: loss=0.7902 (emo=0.0011) (lan=0.0000) (par=0.0044)
  Step 3900: loss=0.8525 (emo=0.0014) (lan=0.0000) (par=0.0002)
  Step 3950: loss=0.6754 (emo=0.2493) (lan=0.0000) (par=0.0001)
  Step 4000: loss=0.7945 (emo=0.3218) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_4000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_4000.npz
  Step 4050: loss=0.7636 (emo=0.8751) (lan=0.0000) (par=0.0001)
  Step 4100: loss=0.5816 (emo=0.7192) (lan=0.0000) (par=0.0007)
  Step 4150: loss=0.4924 (emo=0.0066) (lan=0.0000) (par=0.1060)
  Step 4200: loss=0.8115 (emo=0.8705) (lan=0.0000) (par=0.0015)
  Step 4250: loss=0.8870 (emo=0.6164) (lan=0.0000) (par=0.0000)
  Step 4300: loss=0.6584 (emo=0.0017) (lan=0.0000) (par=0.0023)
  Step 4350: loss=0.5697 (emo=0.5002) (lan=0.0000) (par=0.0005)
  Step 4400: loss=0.4709 (emo=0.1902) (lan=0.0000) (par=0.0010)
  Step 4450: loss=0.6291 (emo=0.0001) (lan=0.0000) (par=0.0001)
  Step 4500: loss=0.5939 (emo=0.0205) (lan=0.0000) (par=0.0007)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_4500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_4500.npz
  Step 4550: loss=0.7896 (emo=0.0001) (lan=0.0000) (par=0.0019)
  Step 4600: loss=0.5073 (emo=0.0008) (lan=0.0000) (par=0.0022)
  Step 4650: loss=0.7522 (emo=0.1740) (lan=0.0000) (par=0.0000)
  Step 4700: loss=0.5338 (emo=0.5290) (lan=0.0000) (par=0.0005)
  Step 4750: loss=0.7992 (emo=0.1469) (lan=0.0000) (par=0.0009)
  Step 4800: loss=0.4685 (emo=0.0487) (lan=0.0000) (par=0.0103)
  Step 4850: loss=0.5584 (emo=0.5530) (lan=0.0000) (par=0.0186)
  Step 4900: loss=0.6055 (emo=1.4813) (lan=0.0000) (par=0.0041)
Epoch 1/10: loss=0.8317
  Val loss: 0.6013
    emotion_acc: 88.55%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/best.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/best.npz
  New best model! (emotion_acc=88.55%)

Starting epoch 2/10
  Step 4950: loss=0.6945 (emo=0.1000) (lan=0.0000) (par=0.0021)
  Step 5000: loss=0.3916 (emo=0.0001) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_5000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_5000.npz
  Step 5050: loss=0.5008 (emo=0.0015) (lan=0.0000) (par=0.0002)
  Step 5100: loss=0.4006 (emo=0.1857) (lan=0.0000) (par=0.0000)
  Step 5150: loss=0.5033 (emo=0.0478) (lan=0.0000) (par=0.0084)
  Step 5200: loss=0.4478 (emo=0.0281) (lan=0.0000) (par=0.0002)
  Step 5250: loss=0.3774 (emo=0.8058) (lan=0.0000) (par=0.5432)
  Step 5300: loss=0.6256 (emo=0.0525) (lan=0.0000) (par=0.1210)
  Step 5350: loss=0.4933 (emo=0.0082) (lan=0.0000) (par=0.0057)
  Step 5400: loss=0.5656 (emo=0.0018) (lan=0.0000) (par=0.0016)
  Step 5450: loss=0.7266 (emo=0.0131) (lan=0.0000) (par=0.0149)
  Step 5500: loss=0.5724 (emo=0.0005) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_5500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_5500.npz
  Step 5550: loss=0.5432 (emo=0.5709) (lan=0.0000) (par=0.0009)
  Step 5600: loss=0.3042 (emo=0.1358) (lan=0.0000) (par=0.0001)
  Step 5650: loss=0.5235 (emo=0.0002) (lan=0.0000) (par=0.0095)
  Step 5700: loss=0.5410 (emo=0.8756) (lan=0.0000) (par=0.0011)
  Step 5750: loss=0.5651 (emo=0.0122) (lan=0.0000) (par=0.0001)
  Step 5800: loss=0.6012 (emo=0.1940) (lan=0.0000) (par=0.0020)
  Step 5850: loss=0.4680 (emo=0.0419) (lan=0.0000) (par=0.0318)
  Step 5900: loss=0.6069 (emo=0.1163) (lan=0.0000) (par=0.3593)
  Step 5950: loss=0.4623 (emo=0.5077) (lan=0.0000) (par=0.0552)
  Step 6000: loss=0.5129 (emo=0.0002) (lan=0.0000) (par=0.0013)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_6000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_6000.npz
  Step 6050: loss=0.4374 (emo=0.0118) (lan=0.0000) (par=0.0110)
  Step 6100: loss=0.5746 (emo=0.0023) (lan=0.0000) (par=0.1407)
  Step 6150: loss=0.6045 (emo=0.6744) (lan=0.0000) (par=0.0275)
  Step 6200: loss=0.5999 (emo=0.7047) (lan=0.0000) (par=0.0002)
  Step 6250: loss=0.3946 (emo=0.5759) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 6300: loss=0.5510 (emo=0.0001) (lan=0.0000) (par=0.0062)
  Step 6350: loss=0.5071 (emo=1.4191) (lan=0.0000) (par=0.0002)
  Step 6400: loss=0.6073 (emo=0.1826) (lan=0.0000) (par=0.0045)
  Step 6450: loss=0.6999 (emo=0.0001) (lan=0.0000) (par=0.0011)
  Step 6500: loss=0.5986 (emo=0.1536) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_6500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_6500.npz
  Step 6550: loss=0.5745 (emo=0.1714) (lan=0.0000) (par=0.0001)
  Step 6600: loss=0.3731 (emo=0.4224) (lan=0.0000) (par=0.0001)
  Step 6650: loss=0.4760 (emo=0.3968) (lan=0.0000) (par=0.0001)
  Step 6700: loss=0.6181 (emo=0.0945) (lan=0.0000) (par=0.0001)
  Step 6750: loss=0.5706 (emo=0.0885) (lan=0.0000) (par=0.0114)
  Step 6800: loss=0.4977 (emo=0.8495) (lan=0.0000) (par=0.0000)
  Step 6850: loss=0.6108 (emo=0.1189) (lan=0.0000) (par=0.0000)
  Step 6900: loss=0.4978 (emo=0.4966) (lan=0.0000) (par=0.0002)
  Step 6950: loss=0.5077 (emo=0.6891) (lan=0.0000) (par=0.0006)
  Step 7000: loss=0.4850 (emo=0.0319) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_7000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_7000.npz
  Step 7050: loss=0.3503 (emo=0.0072) (lan=0.0000) (par=0.0001)
  Step 7100: loss=0.7067 (emo=0.4592) (lan=0.0000) (par=0.0000)
  Step 7150: loss=0.5633 (emo=0.0504) (lan=0.0000) (par=0.0000)
  Step 7200: loss=0.5089 (emo=0.2742) (lan=0.0000) (par=0.0000)
  Step 7250: loss=0.5119 (emo=0.0252) (lan=0.0000) (par=0.0000)
  Step 7300: loss=0.4993 (emo=0.0673) (lan=0.0000) (par=0.0066)
  Step 7350: loss=0.3178 (emo=0.4914) (lan=0.0000) (par=0.0001)
  Step 7400: loss=0.5335 (emo=0.1633) (lan=0.0000) (par=0.0000)
  Step 7450: loss=0.3465 (emo=0.3147) (lan=0.0000) (par=0.0000)
  Step 7500: loss=0.4727 (emo=0.4590) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_7500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_7500.npz
  Step 7550: loss=0.5314 (emo=1.6758) (lan=0.0000) (par=0.4571)
  Step 7600: loss=0.4316 (emo=0.6609) (lan=0.0000) (par=0.0000)
  Step 7650: loss=0.6058 (emo=0.1278) (lan=0.0000) (par=0.0969)
  Step 7700: loss=0.5347 (emo=0.0780) (lan=0.0000) (par=0.0000)
  Step 7750: loss=0.7018 (emo=0.0488) (lan=0.0000) (par=0.0037)
  Step 7800: loss=0.4157 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 7850: loss=0.5639 (emo=0.4034) (lan=0.0000) (par=0.0000)
  Step 7900: loss=0.5149 (emo=0.0041) (lan=0.0000) (par=0.0038)
  Step 7950: loss=0.6015 (emo=0.0225) (lan=0.0000) (par=0.0012)
  Step 8000: loss=0.5575 (emo=0.4480) (lan=0.0000) (par=0.0010)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_8000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_8000.npz
  Step 8050: loss=0.6249 (emo=0.0075) (lan=0.0000) (par=0.0001)
  Step 8100: loss=0.4385 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 8150: loss=0.4488 (emo=0.1642) (lan=0.0000) (par=0.0000)
  Step 8200: loss=0.7342 (emo=0.5131) (lan=0.0000) (par=0.0000)
  Step 8250: loss=0.4250 (emo=0.0053) (lan=0.0000) (par=0.0001)
  Step 8300: loss=0.5729 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 8350: loss=0.6598 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 8400: loss=0.5324 (emo=0.0209) (lan=0.0000) (par=0.0000)
  Step 8450: loss=0.6627 (emo=0.2404) (lan=0.0000) (par=0.0005)
  Step 8500: loss=0.6240 (emo=1.3391) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_8500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_8500.npz
  Step 8550: loss=0.5370 (emo=0.6545) (lan=0.0000) (par=0.0004)
  Step 8600: loss=0.4265 (emo=0.0683) (lan=0.0000) (par=0.0025)
  Step 8650: loss=0.5600 (emo=0.0004) (lan=0.0000) (par=0.0001)
  Step 8700: loss=0.6704 (emo=0.8778) (lan=0.0000) (par=0.0000)
  Step 8750: loss=0.5211 (emo=0.1294) (lan=0.0000) (par=0.0030)
  Step 8800: loss=0.4961 (emo=0.3007) (lan=0.0000) (par=0.0000)
  Step 8850: loss=0.4429 (emo=0.0903) (lan=0.0000) (par=0.0000)
  Step 8900: loss=0.5350 (emo=0.4416) (lan=0.0000) (par=0.0000)
  Step 8950: loss=0.5345 (emo=0.0763) (lan=0.0000) (par=0.0018)
  Step 9000: loss=0.5071 (emo=0.0430) (lan=0.0000) (par=0.0114)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_9000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_9000.npz
  Step 9050: loss=0.4886 (emo=0.0139) (lan=0.0000) (par=0.0003)
  Step 9100: loss=0.4833 (emo=0.0473) (lan=0.0000) (par=0.0003)
  Step 9150: loss=0.4090 (emo=0.1799) (lan=0.0000) (par=0.0001)
  Step 9200: loss=0.5163 (emo=0.5247) (lan=0.0000) (par=0.0015)
  Step 9250: loss=0.7243 (emo=0.8449) (lan=0.0000) (par=0.0007)
  Step 9300: loss=0.5882 (emo=0.4039) (lan=0.0000) (par=0.0000)
  Step 9350: loss=0.7379 (emo=0.7316) (lan=0.0000) (par=0.0000)
  Step 9400: loss=0.5009 (emo=0.0114) (lan=0.0000) (par=0.0581)
  Step 9450: loss=0.4648 (emo=0.0176) (lan=0.0000) (par=0.0015)
  Step 9500: loss=0.3801 (emo=0.0001) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_9500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_9500.npz
  Step 9550: loss=0.4815 (emo=0.0486) (lan=0.0000) (par=0.0033)
  Step 9600: loss=0.4758 (emo=0.0063) (lan=0.0000) (par=0.0017)
  Step 9650: loss=0.4620 (emo=0.1032) (lan=0.0000) (par=0.0001)
  Step 9700: loss=0.3622 (emo=0.0022) (lan=0.0000) (par=0.0000)
  Step 9750: loss=0.5870 (emo=0.0977) (lan=0.0000) (par=0.0206)
  Step 9800: loss=0.4546 (emo=0.0003) (lan=0.0000) (par=0.0568)
  Step 9850: loss=0.3510 (emo=0.0014) (lan=0.0000) (par=0.0245)
Epoch 2/10: loss=0.5232
  Val loss: 0.5493
    emotion_acc: 90.01%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/best.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/best.npz
  New best model! (emotion_acc=90.01%)

Starting epoch 3/10
  Step 9900: loss=0.3559 (emo=0.1611) (lan=0.0000) (par=0.0002)
  Step 9950: loss=0.2860 (emo=0.0139) (lan=0.0000) (par=0.0002)
  Step 10000: loss=0.3161 (emo=0.0666) (lan=0.0000) (par=0.0057)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_10000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_10000.npz
  Step 10050: loss=0.3529 (emo=0.0480) (lan=0.0000) (par=0.0107)
  Step 10100: loss=0.5131 (emo=0.0022) (lan=0.0000) (par=0.0000)
  Step 10150: loss=0.3062 (emo=0.5071) (lan=0.0000) (par=0.0002)
  Step 10200: loss=0.4681 (emo=0.1824) (lan=0.0000) (par=0.0119)
  Step 10250: loss=0.3945 (emo=0.0005) (lan=0.0000) (par=0.0000)
  Step 10300: loss=0.3740 (emo=0.8137) (lan=0.0000) (par=0.0387)
  Step 10350: loss=0.4758 (emo=0.3525) (lan=0.0000) (par=0.0000)
  Step 10400: loss=0.4113 (emo=0.0086) (lan=0.0000) (par=0.0042)
  Step 10450: loss=0.3915 (emo=0.0627) (lan=0.0000) (par=0.0048)
  Step 10500: loss=0.3464 (emo=0.1945) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_10500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_10500.npz
  Step 10550: loss=0.4782 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 10600: loss=0.4032 (emo=0.3854) (lan=0.0000) (par=0.0000)
  Step 10650: loss=0.4957 (emo=0.1210) (lan=0.0000) (par=0.0004)
  Step 10700: loss=0.3405 (emo=0.0027) (lan=0.0000) (par=0.0000)
  Step 10750: loss=0.3953 (emo=0.0736) (lan=0.0000) (par=0.0000)
  Step 10800: loss=0.5156 (emo=0.4001) (lan=0.0000) (par=0.0000)
  Step 10850: loss=0.4147 (emo=0.0611) (lan=0.0000) (par=0.0001)
  Step 10900: loss=0.5123 (emo=0.1210) (lan=0.0000) (par=0.0006)
  Step 10950: loss=0.3656 (emo=0.3367) (lan=0.0000) (par=0.0030)
  Step 11000: loss=0.3819 (emo=0.0008) (lan=0.0000) (par=0.0015)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_11000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_11000.npz
  Step 11050: loss=0.4055 (emo=0.0113) (lan=0.0000) (par=0.0003)
  Step 11100: loss=0.4139 (emo=0.0103) (lan=0.0000) (par=0.0002)
  Step 11150: loss=0.3770 (emo=0.6951) (lan=0.0000) (par=0.0000)
  Step 11200: loss=0.5074 (emo=0.1349) (lan=0.0000) (par=0.0000)
  Step 11250: loss=0.3846 (emo=0.5307) (lan=0.0000) (par=0.0000)
  Step 11300: loss=0.6012 (emo=0.5251) (lan=0.0000) (par=0.0000)
  Step 11350: loss=0.5016 (emo=0.1185) (lan=0.0000) (par=0.0000)
  Step 11400: loss=0.3177 (emo=0.0270) (lan=0.0000) (par=0.0000)
  Step 11450: loss=0.4688 (emo=0.5646) (lan=0.0000) (par=0.0000)
  Step 11500: loss=0.4346 (emo=0.5533) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_11500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_11500.npz
  Step 11550: loss=0.3511 (emo=0.0025) (lan=0.0000) (par=0.0012)
  Step 11600: loss=0.3306 (emo=0.0120) (lan=0.0000) (par=0.0704)
  Step 11650: loss=0.3816 (emo=0.1997) (lan=0.0000) (par=0.0003)
  Step 11700: loss=0.5666 (emo=0.3537) (lan=0.0000) (par=0.0001)
  Step 11750: loss=0.3265 (emo=0.0275) (lan=0.0000) (par=0.0016)
  Step 11800: loss=0.2459 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 11850: loss=0.3001 (emo=0.0728) (lan=0.0000) (par=0.0004)
  Step 11900: loss=0.4697 (emo=0.1140) (lan=0.0000) (par=0.0000)
  Step 11950: loss=0.3834 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 12000: loss=0.5528 (emo=1.8247) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_12000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_12000.npz
  Step 12050: loss=0.4136 (emo=0.0001) (lan=0.0000) (par=0.0003)
  Step 12100: loss=0.4509 (emo=0.0006) (lan=0.0000) (par=0.0001)
  Step 12150: loss=0.6429 (emo=0.0449) (lan=0.0000) (par=0.0000)
  Step 12200: loss=0.4280 (emo=0.0982) (lan=0.0000) (par=0.0000)
  Step 12250: loss=0.3859 (emo=0.1055) (lan=0.0000) (par=0.0001)
  Step 12300: loss=0.4465 (emo=0.0129) (lan=0.0000) (par=0.0000)
  Step 12350: loss=0.4035 (emo=0.2942) (lan=0.0000) (par=0.0000)
  Step 12400: loss=0.4576 (emo=0.0070) (lan=0.0000) (par=0.0077)
  Step 12450: loss=0.4337 (emo=0.1847) (lan=0.0000) (par=0.0091)
  Step 12500: loss=0.4745 (emo=0.0034) (lan=0.0000) (par=0.0007)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_12500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_12500.npz
  Step 12550: loss=0.4676 (emo=0.0344) (lan=0.0000) (par=0.0006)
  Step 12600: loss=0.5527 (emo=0.0623) (lan=0.0000) (par=0.0005)
  Step 12650: loss=0.3302 (emo=0.1267) (lan=0.0000) (par=0.0004)
  Step 12700: loss=0.4030 (emo=0.2012) (lan=0.0000) (par=0.0000)
  Step 12750: loss=0.3845 (emo=0.5841) (lan=0.0000) (par=0.0232)
  Step 12800: loss=0.5032 (emo=0.0010) (lan=0.0000) (par=0.0093)
  Step 12850: loss=0.3486 (emo=0.0605) (lan=0.0000) (par=0.0003)
  Step 12900: loss=0.4991 (emo=0.2559) (lan=0.0000) (par=0.0000)
  Step 12950: loss=0.4123 (emo=0.2436) (lan=0.0000) (par=0.0000)
  Step 13000: loss=0.2856 (emo=0.1196) (lan=0.0000) (par=0.0003)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_13000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_13000.npz
  Step 13050: loss=0.4605 (emo=0.3519) (lan=0.0000) (par=0.0001)
  Step 13100: loss=0.4043 (emo=0.0586) (lan=0.0000) (par=0.0004)
  Step 13150: loss=0.4751 (emo=0.0975) (lan=0.0000) (par=0.0000)
  Step 13200: loss=0.2490 (emo=0.0249) (lan=0.0000) (par=0.0001)
  Step 13250: loss=0.3940 (emo=0.4205) (lan=0.0000) (par=0.0000)
  Step 13300: loss=0.5086 (emo=0.9183) (lan=0.0000) (par=0.0006)
  Step 13350: loss=0.4586 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 13400: loss=0.6723 (emo=0.0084) (lan=0.0000) (par=0.0001)
  Step 13450: loss=0.2427 (emo=0.0159) (lan=0.0000) (par=0.0000)
  Step 13500: loss=0.3284 (emo=0.0536) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_13500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_13500.npz
  Step 13550: loss=0.3547 (emo=0.1192) (lan=0.0000) (par=0.0000)
  Step 13600: loss=0.3957 (emo=0.0006) (lan=0.0000) (par=0.0001)
  Step 13650: loss=0.4660 (emo=0.3735) (lan=0.0000) (par=0.0001)
  Step 13700: loss=0.5754 (emo=0.1589) (lan=0.0000) (par=0.0000)
  Step 13750: loss=0.3501 (emo=0.0003) (lan=0.0000) (par=0.0122)
  Step 13800: loss=0.3924 (emo=0.0009) (lan=0.0000) (par=0.0021)
  Step 13850: loss=0.3366 (emo=0.1211) (lan=0.0000) (par=0.0003)
  Step 13900: loss=0.3841 (emo=0.1500) (lan=0.0000) (par=0.0002)
  Step 13950: loss=0.5328 (emo=0.0014) (lan=0.0000) (par=0.0001)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 14000: loss=0.3920 (emo=0.0558) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_14000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_14000.npz
  Step 14050: loss=0.4564 (emo=0.0439) (lan=0.0000) (par=0.0000)
  Step 14100: loss=0.4394 (emo=0.1685) (lan=0.0000) (par=0.0002)
  Step 14150: loss=0.4838 (emo=0.1081) (lan=0.0000) (par=0.0011)
  Step 14200: loss=0.5521 (emo=0.1283) (lan=0.0000) (par=0.0005)
  Step 14250: loss=0.4268 (emo=0.0660) (lan=0.0000) (par=0.0000)
  Step 14300: loss=0.2967 (emo=0.0068) (lan=0.0000) (par=0.0000)
  Step 14350: loss=0.4973 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 14400: loss=0.3446 (emo=0.8292) (lan=0.0000) (par=0.0000)
  Step 14450: loss=0.3796 (emo=0.0004) (lan=0.0000) (par=0.0003)
  Step 14500: loss=0.3903 (emo=0.1065) (lan=0.0000) (par=0.0075)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_14500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_14500.npz
  Step 14550: loss=0.3479 (emo=0.3167) (lan=0.0000) (par=0.0065)
  Step 14600: loss=0.5717 (emo=0.0002) (lan=0.0000) (par=0.0001)
  Step 14650: loss=0.3662 (emo=0.0351) (lan=0.0000) (par=0.0001)
  Step 14700: loss=0.6002 (emo=0.3642) (lan=0.0000) (par=0.0000)
  Step 14750: loss=0.5350 (emo=0.0002) (lan=0.0000) (par=0.0012)
  Step 14800: loss=0.3561 (emo=0.0017) (lan=0.0000) (par=0.0000)
Epoch 3/10: loss=0.4222
  Val loss: 0.5359
    emotion_acc: 90.38%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/best.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/best.npz
  New best model! (emotion_acc=90.38%)

Starting epoch 4/10
  Step 14850: loss=0.2551 (emo=0.0221) (lan=0.0000) (par=0.0000)
  Step 14900: loss=0.2846 (emo=0.7634) (lan=0.0000) (par=0.0033)
  Step 14950: loss=0.3130 (emo=1.1040) (lan=0.0000) (par=0.0011)
  Step 15000: loss=0.2143 (emo=0.0717) (lan=0.0000) (par=0.0004)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_15000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_15000.npz
  Step 15050: loss=0.4188 (emo=0.0605) (lan=0.0000) (par=0.0000)
  Step 15100: loss=0.2649 (emo=0.0142) (lan=0.0000) (par=0.0000)
  Step 15150: loss=0.2289 (emo=0.0793) (lan=0.0000) (par=0.0002)
  Step 15200: loss=0.1624 (emo=0.1774) (lan=0.0000) (par=0.0002)
  Step 15250: loss=0.2816 (emo=0.2486) (lan=0.0000) (par=0.0008)
  Step 15300: loss=0.3512 (emo=0.0311) (lan=0.0000) (par=0.0239)
  Step 15350: loss=0.3343 (emo=0.0791) (lan=0.0000) (par=0.0000)
  Step 15400: loss=0.3456 (emo=0.6483) (lan=0.0000) (par=0.0000)
  Step 15450: loss=0.3458 (emo=0.0005) (lan=0.0000) (par=0.0001)
  Step 15500: loss=0.3594 (emo=0.0013) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_15500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_15500.npz
  Step 15550: loss=0.4325 (emo=0.3534) (lan=0.0000) (par=0.0000)
  Step 15600: loss=0.2762 (emo=0.3507) (lan=0.0000) (par=0.0000)
  Step 15650: loss=0.3399 (emo=0.0131) (lan=0.0000) (par=0.0000)
  Step 15700: loss=0.2471 (emo=0.0230) (lan=0.0000) (par=0.0000)
  Step 15750: loss=0.4114 (emo=0.0996) (lan=0.0000) (par=0.0000)
  Step 15800: loss=0.2875 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 15850: loss=0.2932 (emo=0.0877) (lan=0.0000) (par=0.0000)
  Step 15900: loss=0.3509 (emo=0.0019) (lan=0.0000) (par=0.0003)
  Step 15950: loss=0.2899 (emo=0.0470) (lan=0.0000) (par=0.0000)
  Step 16000: loss=0.3127 (emo=0.2717) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_16000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_16000.npz
  Step 16050: loss=0.4785 (emo=0.3037) (lan=0.0000) (par=0.0006)
  Step 16100: loss=0.4726 (emo=0.1477) (lan=0.0000) (par=0.0000)
  Step 16150: loss=0.2523 (emo=0.5595) (lan=0.0000) (par=0.0000)
  Step 16200: loss=0.3800 (emo=0.0605) (lan=0.0000) (par=0.0152)
  Step 16250: loss=0.4095 (emo=0.0030) (lan=0.0000) (par=0.0000)
  Step 16300: loss=0.2938 (emo=0.0077) (lan=0.0000) (par=0.0000)
  Step 16350: loss=0.3619 (emo=0.0972) (lan=0.0000) (par=0.0000)
  Step 16400: loss=0.3410 (emo=0.1408) (lan=0.0000) (par=0.0002)
  Step 16450: loss=0.2530 (emo=0.1996) (lan=0.0000) (par=0.0000)
  Step 16500: loss=0.5083 (emo=0.0191) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_16500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_16500.npz
  Step 16550: loss=0.3113 (emo=0.1965) (lan=0.0000) (par=0.0000)
  Step 16600: loss=0.3054 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 16650: loss=0.2255 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 16700: loss=0.3345 (emo=0.2194) (lan=0.0000) (par=0.0003)
  Step 16750: loss=0.4282 (emo=0.1291) (lan=0.0000) (par=0.0000)
  Step 16800: loss=0.2846 (emo=0.0467) (lan=0.0000) (par=0.0000)
  Step 16850: loss=0.3869 (emo=0.0295) (lan=0.0000) (par=0.0000)
  Step 16900: loss=0.4140 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 16950: loss=0.2437 (emo=0.3410) (lan=0.0000) (par=0.0000)
  Step 17000: loss=0.5070 (emo=0.0490) (lan=0.0000) (par=0.0043)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_17000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_17000.npz
  Step 17050: loss=0.3975 (emo=0.1872) (lan=0.0000) (par=0.0000)
  Step 17100: loss=0.4125 (emo=0.0450) (lan=0.0000) (par=0.0000)
  Step 17150: loss=0.3224 (emo=0.2573) (lan=0.0000) (par=0.0006)
  Step 17200: loss=0.2954 (emo=0.0080) (lan=0.0000) (par=0.0001)
  Step 17250: loss=0.3677 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 17300: loss=0.2919 (emo=0.0021) (lan=0.0000) (par=0.0172)
  Step 17350: loss=0.3592 (emo=0.0004) (lan=0.0000) (par=0.0001)
  Step 17400: loss=0.4122 (emo=0.1518) (lan=0.0000) (par=0.0001)
  Step 17450: loss=0.2614 (emo=0.0186) (lan=0.0000) (par=0.0000)
  Step 17500: loss=0.3553 (emo=0.1431) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_17500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_17500.npz
  Step 17550: loss=0.3217 (emo=0.2326) (lan=0.0000) (par=0.0000)
  Step 17600: loss=0.2130 (emo=0.0034) (lan=0.0000) (par=0.0000)
  Step 17650: loss=0.5088 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 17700: loss=0.4035 (emo=0.7724) (lan=0.0000) (par=0.0000)
  Step 17750: loss=0.4756 (emo=0.2237) (lan=0.0000) (par=0.0000)
  Step 17800: loss=0.3341 (emo=0.0047) (lan=0.0000) (par=0.0101)
  Step 17850: loss=0.3003 (emo=0.1114) (lan=0.0000) (par=0.0009)
  Step 17900: loss=0.5014 (emo=0.0146) (lan=0.0000) (par=0.0000)
  Step 17950: loss=0.3113 (emo=0.2212) (lan=0.0000) (par=0.0000)
  Step 18000: loss=0.3419 (emo=0.0283) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_18000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_18000.npz
  Step 18050: loss=0.2749 (emo=0.0608) (lan=0.0000) (par=0.0000)
  Step 18100: loss=0.3805 (emo=0.0903) (lan=0.0000) (par=0.0002)
  Step 18150: loss=0.3574 (emo=0.0077) (lan=0.0000) (par=0.0000)
  Step 18200: loss=0.3912 (emo=0.0046) (lan=0.0000) (par=0.0002)
  Step 18250: loss=0.2588 (emo=0.0110) (lan=0.0000) (par=0.0000)
  Step 18300: loss=0.3148 (emo=0.0001) (lan=0.0000) (par=0.0001)
  Step 18350: loss=0.3187 (emo=0.3616) (lan=0.0000) (par=0.0000)
  Step 18400: loss=0.2597 (emo=0.0624) (lan=0.0000) (par=0.0000)
  Step 18450: loss=0.4378 (emo=0.0000) (lan=0.0000) (par=0.0008)
  Step 18500: loss=0.3758 (emo=0.0424) (lan=0.0000) (par=0.0002)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_18500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_18500.npz
  Step 18550: loss=0.2129 (emo=0.0020) (lan=0.0000) (par=0.0005)
  Step 18600: loss=0.3907 (emo=0.0021) (lan=0.0000) (par=0.0000)
  Step 18650: loss=0.2471 (emo=0.1983) (lan=0.0000) (par=0.0000)
  Step 18700: loss=0.3494 (emo=0.0136) (lan=0.0000) (par=0.0124)
  Step 18750: loss=0.2093 (emo=0.0066) (lan=0.0000) (par=0.0000)
  Step 18800: loss=0.3174 (emo=0.0100) (lan=0.0000) (par=0.0000)
  Step 18850: loss=0.3994 (emo=0.0366) (lan=0.0000) (par=0.0000)
  Step 18900: loss=0.2980 (emo=0.0001) (lan=0.0000) (par=0.0001)
  Step 18950: loss=0.3259 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 19000: loss=0.2827 (emo=0.0831) (lan=0.0000) (par=0.0037)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_19000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_19000.npz
  Step 19050: loss=0.3889 (emo=0.5229) (lan=0.0000) (par=0.0000)
  Step 19100: loss=0.2743 (emo=0.0379) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 19150: loss=0.4294 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 19200: loss=0.3182 (emo=0.1936) (lan=0.0000) (par=0.0021)
  Step 19250: loss=0.3622 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 19300: loss=0.4112 (emo=0.0155) (lan=0.0000) (par=0.0001)
  Step 19350: loss=0.3986 (emo=0.3628) (lan=0.0000) (par=0.0004)
  Step 19400: loss=0.3677 (emo=0.0085) (lan=0.0000) (par=0.0601)
  Step 19450: loss=0.4524 (emo=0.0006) (lan=0.0000) (par=0.0064)
  Step 19500: loss=0.5138 (emo=0.0778) (lan=0.0000) (par=0.0019)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_19500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_19500.npz
  Step 19550: loss=0.4931 (emo=0.0080) (lan=0.0000) (par=0.0000)
  Step 19600: loss=0.3864 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 19650: loss=0.2710 (emo=0.0955) (lan=0.0000) (par=0.0001)
  Step 19700: loss=0.3927 (emo=0.0240) (lan=0.0000) (par=0.0000)
Epoch 4/10: loss=0.3431
  Val loss: 0.5188
    emotion_acc: 90.42%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/best.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/best.npz
  New best model! (emotion_acc=90.42%)

Starting epoch 5/10
  Step 19750: loss=0.2814 (emo=0.4725) (lan=0.0000) (par=0.0001)
  Step 19800: loss=0.3103 (emo=0.2885) (lan=0.0000) (par=0.0000)
  Step 19850: loss=0.3345 (emo=0.4684) (lan=0.0000) (par=0.0000)
  Step 19900: loss=0.2256 (emo=0.4528) (lan=0.0000) (par=0.0000)
  Step 19950: loss=0.1708 (emo=0.0465) (lan=0.0000) (par=0.0040)
  Step 20000: loss=0.3002 (emo=0.5421) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_20000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_20000.npz
  Step 20050: loss=0.2223 (emo=0.2519) (lan=0.0000) (par=0.0000)
  Step 20100: loss=0.2309 (emo=0.2887) (lan=0.0000) (par=0.0000)
  Step 20150: loss=0.3459 (emo=0.0358) (lan=0.0000) (par=0.0000)
  Step 20200: loss=0.2847 (emo=0.1143) (lan=0.0000) (par=0.0000)
  Step 20250: loss=0.3083 (emo=0.0515) (lan=0.0000) (par=0.0000)
  Step 20300: loss=0.2469 (emo=0.1984) (lan=0.0000) (par=0.0000)
  Step 20350: loss=0.1457 (emo=0.0552) (lan=0.0000) (par=0.0034)
  Step 20400: loss=0.1540 (emo=0.5809) (lan=0.0000) (par=0.0007)
  Step 20450: loss=0.2933 (emo=0.7183) (lan=0.0000) (par=0.0000)
  Step 20500: loss=0.3442 (emo=0.0139) (lan=0.0000) (par=0.0014)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_20500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_20500.npz
  Step 20550: loss=0.2605 (emo=0.2431) (lan=0.0000) (par=0.0001)
  Step 20600: loss=0.2605 (emo=0.3175) (lan=0.0000) (par=0.0000)
  Step 20650: loss=0.2472 (emo=0.0336) (lan=0.0000) (par=0.0000)
  Step 20700: loss=0.1916 (emo=0.3879) (lan=0.0000) (par=0.0001)
  Step 20750: loss=0.2531 (emo=0.0216) (lan=0.0000) (par=0.0000)
  Step 20800: loss=0.2335 (emo=0.0265) (lan=0.0000) (par=0.0000)
  Step 20850: loss=0.1832 (emo=0.0380) (lan=0.0000) (par=0.0000)
  Step 20900: loss=0.2589 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 20950: loss=0.2719 (emo=0.1684) (lan=0.0000) (par=0.0001)
  Step 21000: loss=0.2880 (emo=0.0045) (lan=0.0000) (par=0.0097)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_21000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_21000.npz
  Step 21050: loss=0.4168 (emo=0.1269) (lan=0.0000) (par=0.0001)
  Step 21100: loss=0.2777 (emo=0.0005) (lan=0.0000) (par=0.0000)
  Step 21150: loss=0.2262 (emo=0.0890) (lan=0.0000) (par=0.0000)
  Step 21200: loss=0.4154 (emo=0.8756) (lan=0.0000) (par=0.0001)
  Step 21250: loss=0.1984 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 21300: loss=0.2898 (emo=0.0014) (lan=0.0000) (par=0.0000)
  Step 21350: loss=0.1872 (emo=0.0012) (lan=0.0000) (par=0.0000)
  Step 21400: loss=0.2554 (emo=0.1012) (lan=0.0000) (par=0.0000)
  Step 21450: loss=0.3101 (emo=0.1317) (lan=0.0000) (par=0.0000)
  Step 21500: loss=0.2422 (emo=0.0041) (lan=0.0000) (par=0.0003)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_21500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_21500.npz
  Step 21550: loss=0.1757 (emo=0.0158) (lan=0.0000) (par=0.0350)
  Step 21600: loss=0.2832 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 21650: loss=0.1907 (emo=0.0458) (lan=0.0000) (par=0.0001)
  Step 21700: loss=0.2917 (emo=0.0234) (lan=0.0000) (par=0.0000)
  Step 21750: loss=0.2611 (emo=0.0251) (lan=0.0000) (par=0.0000)
  Step 21800: loss=0.2941 (emo=0.0915) (lan=0.0000) (par=0.0000)
  Step 21850: loss=0.1551 (emo=0.0519) (lan=0.0000) (par=0.0000)
  Step 21900: loss=0.2474 (emo=0.2948) (lan=0.0000) (par=0.0000)
  Step 21950: loss=0.2154 (emo=0.0194) (lan=0.0000) (par=0.0001)
  Step 22000: loss=0.2153 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_22000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_22000.npz
  Step 22050: loss=0.2479 (emo=0.0281) (lan=0.0000) (par=0.0000)
  Step 22100: loss=0.1068 (emo=0.0093) (lan=0.0000) (par=0.0000)
  Step 22150: loss=0.3813 (emo=0.3187) (lan=0.0000) (par=0.0001)
  Step 22200: loss=0.2582 (emo=0.0997) (lan=0.0000) (par=0.0000)
  Step 22250: loss=0.3226 (emo=0.0129) (lan=0.0000) (par=0.0000)
  Step 22300: loss=0.2893 (emo=0.2479) (lan=0.0000) (par=0.0000)
  Step 22350: loss=0.1921 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 22400: loss=0.3467 (emo=0.0708) (lan=0.0000) (par=0.0000)
  Step 22450: loss=0.3398 (emo=0.0005) (lan=0.0000) (par=0.0000)
  Step 22500: loss=0.2017 (emo=0.0393) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_22500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_22500.npz
  Step 22550: loss=0.2380 (emo=0.0800) (lan=0.0000) (par=0.0000)
  Step 22600: loss=0.1936 (emo=0.0015) (lan=0.0000) (par=0.0000)
  Step 22650: loss=0.2172 (emo=0.0307) (lan=0.0000) (par=0.0000)
  Step 22700: loss=0.2082 (emo=0.0062) (lan=0.0000) (par=0.0000)
  Step 22750: loss=0.2441 (emo=0.0004) (lan=0.0000) (par=0.0000)
  Step 22800: loss=0.3091 (emo=0.0799) (lan=0.0000) (par=0.0000)
  Step 22850: loss=0.3350 (emo=0.2353) (lan=0.0000) (par=0.0000)
  Step 22900: loss=0.1931 (emo=0.0213) (lan=0.0000) (par=0.0000)
  Step 22950: loss=0.2763 (emo=0.0709) (lan=0.0000) (par=0.0000)
  Step 23000: loss=0.4182 (emo=0.2705) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_23000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_23000.npz
  Step 23050: loss=0.3492 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 23100: loss=0.2482 (emo=0.0469) (lan=0.0000) (par=0.0000)
  Step 23150: loss=0.3387 (emo=0.1669) (lan=0.0000) (par=0.0000)
  Step 23200: loss=0.2393 (emo=0.3699) (lan=0.0000) (par=0.0001)
  Step 23250: loss=0.2865 (emo=0.0005) (lan=0.0000) (par=0.0000)
  Step 23300: loss=0.2169 (emo=0.3283) (lan=0.0000) (par=0.0000)
  Step 23350: loss=0.4868 (emo=0.0683) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 23400: loss=0.3108 (emo=0.1950) (lan=0.0000) (par=0.0094)
  Step 23450: loss=0.2208 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 23500: loss=0.2427 (emo=0.3284) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_23500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_23500.npz
  Step 23550: loss=0.1696 (emo=0.0423) (lan=0.0000) (par=0.0000)
  Step 23600: loss=0.2180 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 23650: loss=0.3633 (emo=0.0173) (lan=0.0000) (par=0.0000)
  Step 23700: loss=0.4537 (emo=0.0031) (lan=0.0000) (par=0.0000)
  Step 23750: loss=0.2460 (emo=0.0325) (lan=0.0000) (par=0.0000)
  Step 23800: loss=0.3999 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 23850: loss=0.4103 (emo=0.5495) (lan=0.0000) (par=0.0000)
  Step 23900: loss=0.4177 (emo=0.1134) (lan=0.0000) (par=0.0000)
  Step 23950: loss=0.3221 (emo=0.0449) (lan=0.0000) (par=0.0107)
  Step 24000: loss=0.2696 (emo=0.0002) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_24000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_24000.npz
  Step 24050: loss=0.3373 (emo=0.1875) (lan=0.0000) (par=0.0000)
  Step 24100: loss=0.2547 (emo=0.2771) (lan=0.0000) (par=0.0000)
  Step 24150: loss=0.2675 (emo=0.3613) (lan=0.0000) (par=0.0000)
  Step 24200: loss=0.1503 (emo=0.0286) (lan=0.0000) (par=0.0000)
  Step 24250: loss=0.3427 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 24300: loss=0.2592 (emo=0.0045) (lan=0.0000) (par=0.0000)
  Step 24350: loss=0.3100 (emo=0.1826) (lan=0.0000) (par=0.0000)
  Step 24400: loss=0.2845 (emo=0.2313) (lan=0.0000) (par=0.0000)
  Step 24450: loss=0.3482 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 24500: loss=0.3064 (emo=0.5790) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_24500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_24500.npz
  Step 24550: loss=0.3828 (emo=0.0414) (lan=0.0000) (par=0.0000)
  Step 24600: loss=0.1649 (emo=0.2427) (lan=0.0000) (par=0.0000)
  Step 24650: loss=0.3594 (emo=0.0000) (lan=0.0000) (par=0.0000)
Epoch 5/10: loss=0.2739
  Val loss: 0.5360
    emotion_acc: 91.02%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/best.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/best.npz
  New best model! (emotion_acc=91.02%)

Starting epoch 6/10
  Step 24700: loss=0.1828 (emo=0.5581) (lan=0.0000) (par=0.0001)
  Step 24750: loss=0.1678 (emo=0.0000) (lan=0.0000) (par=0.0007)
  Step 24800: loss=0.1829 (emo=0.0793) (lan=0.0000) (par=0.0000)
  Step 24850: loss=0.1471 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 24900: loss=0.2119 (emo=0.0701) (lan=0.0000) (par=0.0000)
  Step 24950: loss=0.1413 (emo=0.0247) (lan=0.0000) (par=0.0000)
  Step 25000: loss=0.2083 (emo=0.0045) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_25000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_25000.npz
  Step 25050: loss=0.1431 (emo=0.1112) (lan=0.0000) (par=0.0052)
  Step 25100: loss=0.2266 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 25150: loss=0.2425 (emo=0.0552) (lan=0.0000) (par=0.0000)
  Step 25200: loss=0.2280 (emo=0.0001) (lan=0.0000) (par=0.0004)
  Step 25250: loss=0.2040 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 25300: loss=0.2379 (emo=0.1472) (lan=0.0000) (par=0.0001)
  Step 25350: loss=0.1939 (emo=0.0832) (lan=0.0000) (par=0.0000)
  Step 25400: loss=0.3054 (emo=0.0087) (lan=0.0000) (par=0.0000)
  Step 25450: loss=0.1993 (emo=0.0030) (lan=0.0000) (par=0.0000)
  Step 25500: loss=0.3175 (emo=0.0271) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_25500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_25500.npz
  Step 25550: loss=0.1590 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 25600: loss=0.1837 (emo=0.0000) (lan=0.0000) (par=0.0002)
  Step 25650: loss=0.1745 (emo=0.4120) (lan=0.0000) (par=0.0000)
  Step 25700: loss=0.1687 (emo=0.0022) (lan=0.0000) (par=0.0000)
  Step 25750: loss=0.2931 (emo=0.0313) (lan=0.0000) (par=0.0025)
  Step 25800: loss=0.1828 (emo=0.0581) (lan=0.0000) (par=0.0000)
  Step 25850: loss=0.1749 (emo=0.0021) (lan=0.0000) (par=0.0008)
  Step 25900: loss=0.2992 (emo=0.0739) (lan=0.0000) (par=0.0000)
  Step 25950: loss=0.2496 (emo=0.0168) (lan=0.0000) (par=0.0000)
  Step 26000: loss=0.2014 (emo=0.0645) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_26000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_26000.npz
  Step 26050: loss=0.3430 (emo=0.0030) (lan=0.0000) (par=0.0000)
  Step 26100: loss=0.2175 (emo=0.1909) (lan=0.0000) (par=0.0000)
  Step 26150: loss=0.3049 (emo=0.0977) (lan=0.0000) (par=0.1315)
  Step 26200: loss=0.1938 (emo=0.0738) (lan=0.0000) (par=0.0000)
  Step 26250: loss=0.1502 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 26300: loss=0.1436 (emo=0.0022) (lan=0.0000) (par=0.0047)
  Step 26350: loss=0.1799 (emo=0.0004) (lan=0.0000) (par=0.0002)
  Step 26400: loss=0.1891 (emo=0.0002) (lan=0.0000) (par=0.0035)
  Step 26450: loss=0.3003 (emo=0.1144) (lan=0.0000) (par=0.0002)
  Step 26500: loss=0.2490 (emo=0.0122) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_26500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_26500.npz
  Step 26550: loss=0.3082 (emo=0.0223) (lan=0.0000) (par=0.0000)
  Step 26600: loss=0.2741 (emo=0.1483) (lan=0.0000) (par=0.0000)
  Step 26650: loss=0.1555 (emo=0.0044) (lan=0.0000) (par=0.0000)
  Step 26700: loss=0.1455 (emo=0.0177) (lan=0.0000) (par=0.0000)
  Step 26750: loss=0.2011 (emo=0.0001) (lan=0.0000) (par=0.0002)
  Step 26800: loss=0.1085 (emo=0.0149) (lan=0.0000) (par=0.0003)
  Step 26850: loss=0.1649 (emo=0.0010) (lan=0.0000) (par=0.0000)
  Step 26900: loss=0.1315 (emo=0.0008) (lan=0.0000) (par=0.0000)
  Step 26950: loss=0.2007 (emo=0.0625) (lan=0.0000) (par=0.0000)
  Step 27000: loss=0.2019 (emo=0.0123) (lan=0.0000) (par=0.0108)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_27000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_27000.npz
  Step 27050: loss=0.1818 (emo=0.0366) (lan=0.0000) (par=0.0000)
  Step 27100: loss=0.1936 (emo=0.0921) (lan=0.0000) (par=0.0006)
  Step 27150: loss=0.1802 (emo=0.0146) (lan=0.0000) (par=0.0000)
  Step 27200: loss=0.3091 (emo=0.5853) (lan=0.0000) (par=0.0000)
  Step 27250: loss=0.2347 (emo=0.0387) (lan=0.0000) (par=0.0002)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 27300: loss=0.2543 (emo=0.1235) (lan=0.0000) (par=0.0000)
  Step 27350: loss=0.2217 (emo=0.0000) (lan=0.0000) (par=0.0003)
  Step 27400: loss=0.1710 (emo=0.0030) (lan=0.0000) (par=0.0000)
  Step 27450: loss=0.2932 (emo=0.2925) (lan=0.0000) (par=0.0000)
  Step 27500: loss=0.2159 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_27500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_27500.npz
  Step 27550: loss=0.1898 (emo=0.1067) (lan=0.0000) (par=0.0062)
  Step 27600: loss=0.2053 (emo=0.0487) (lan=0.0000) (par=0.0000)
  Step 27650: loss=0.2219 (emo=0.1071) (lan=0.0000) (par=0.0000)
  Step 27700: loss=0.1760 (emo=0.0189) (lan=0.0000) (par=0.0000)
  Step 27750: loss=0.1772 (emo=0.2017) (lan=0.0000) (par=0.0000)
  Step 27800: loss=0.2536 (emo=0.0129) (lan=0.0000) (par=0.0000)
  Step 27850: loss=0.2765 (emo=0.0101) (lan=0.0000) (par=0.0001)
  Step 27900: loss=0.2633 (emo=0.0409) (lan=0.0000) (par=0.0000)
  Step 27950: loss=0.2035 (emo=0.0000) (lan=0.0000) (par=0.0002)
  Step 28000: loss=0.2270 (emo=0.0016) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_28000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_28000.npz
  Step 28050: loss=0.2464 (emo=0.0917) (lan=0.0000) (par=0.0000)
  Step 28100: loss=0.2666 (emo=0.0356) (lan=0.0000) (par=0.0018)
  Step 28150: loss=0.1857 (emo=0.0177) (lan=0.0000) (par=0.0000)
  Step 28200: loss=0.1755 (emo=0.3015) (lan=0.0000) (par=0.0006)
  Step 28250: loss=0.1521 (emo=0.0012) (lan=0.0000) (par=0.0001)
  Step 28300: loss=0.1528 (emo=0.0011) (lan=0.0000) (par=0.0000)
  Step 28350: loss=0.1555 (emo=0.0518) (lan=0.0000) (par=0.0000)
  Step 28400: loss=0.1529 (emo=0.0030) (lan=0.0000) (par=0.0005)
  Step 28450: loss=0.2964 (emo=0.0379) (lan=0.0000) (par=0.0000)
  Step 28500: loss=0.1683 (emo=0.0031) (lan=0.0000) (par=0.0002)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_28500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_28500.npz
  Step 28550: loss=0.2225 (emo=0.0450) (lan=0.0000) (par=0.0000)
  Step 28600: loss=0.2271 (emo=0.0033) (lan=0.0001) (par=0.0001)
  Step 28650: loss=0.2543 (emo=0.0001) (lan=0.0000) (par=0.0001)
  Step 28700: loss=0.2096 (emo=0.1307) (lan=0.0000) (par=0.0000)
  Step 28750: loss=0.1990 (emo=0.0194) (lan=0.0000) (par=0.0255)
  Step 28800: loss=0.1889 (emo=0.3231) (lan=0.0000) (par=0.0000)
  Step 28850: loss=0.2616 (emo=0.7326) (lan=0.0000) (par=0.0000)
  Step 28900: loss=0.2078 (emo=0.1025) (lan=0.0000) (par=0.0000)
  Step 28950: loss=0.1776 (emo=0.0074) (lan=0.0000) (par=0.0000)
  Step 29000: loss=0.1810 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_29000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_29000.npz
  Step 29050: loss=0.2947 (emo=0.0009) (lan=0.0000) (par=0.0001)
  Step 29100: loss=0.3663 (emo=0.0005) (lan=0.0000) (par=0.0000)
  Step 29150: loss=0.2968 (emo=0.0421) (lan=0.0000) (par=0.0000)
  Step 29200: loss=0.1219 (emo=0.0092) (lan=0.0000) (par=0.0000)
  Step 29250: loss=0.1376 (emo=0.0473) (lan=0.0000) (par=0.0000)
  Step 29300: loss=0.1535 (emo=0.0123) (lan=0.0000) (par=0.0000)
  Step 29350: loss=0.2697 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 29400: loss=0.1256 (emo=0.0144) (lan=0.0000) (par=0.0000)
  Step 29450: loss=0.2291 (emo=0.0485) (lan=0.0000) (par=0.0000)
  Step 29500: loss=0.1981 (emo=0.0947) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_29500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_29500.npz
  Step 29550: loss=0.1771 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 29600: loss=0.2312 (emo=0.0000) (lan=0.0000) (par=0.0332)
Epoch 6/10: loss=0.2114
  Val loss: 0.5718
    emotion_acc: 91.02%
    language_acc: 100.00%

Starting epoch 7/10
  Step 29650: loss=0.0801 (emo=0.0004) (lan=0.0000) (par=0.0002)
  Step 29700: loss=0.0992 (emo=0.0034) (lan=0.0000) (par=0.0000)
  Step 29750: loss=0.1813 (emo=0.1637) (lan=0.0000) (par=0.0000)
  Step 29800: loss=0.1554 (emo=0.1805) (lan=0.0000) (par=0.0001)
  Step 29850: loss=0.1414 (emo=0.0174) (lan=0.0000) (par=0.0000)
  Step 29900: loss=0.1668 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 29950: loss=0.1191 (emo=0.0647) (lan=0.0000) (par=0.0036)
  Step 30000: loss=0.1742 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_30000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_30000.npz
  Step 30050: loss=0.0904 (emo=0.0069) (lan=0.0000) (par=0.0000)
  Step 30100: loss=0.0978 (emo=0.0109) (lan=0.0000) (par=0.0007)
  Step 30150: loss=0.1664 (emo=0.0280) (lan=0.0000) (par=0.0000)
  Step 30200: loss=0.1980 (emo=0.0006) (lan=0.0000) (par=0.0004)
  Step 30250: loss=0.2206 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 30300: loss=0.1053 (emo=0.0020) (lan=0.0000) (par=0.0001)
  Step 30350: loss=0.1403 (emo=0.0000) (lan=0.0000) (par=0.0104)
  Step 30400: loss=0.1759 (emo=0.0166) (lan=0.0000) (par=0.0000)
  Step 30450: loss=0.0831 (emo=0.0145) (lan=0.0000) (par=0.0000)
  Step 30500: loss=0.1252 (emo=0.0001) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_30500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_30500.npz
  Step 30550: loss=0.1751 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 30600: loss=0.1319 (emo=0.5552) (lan=0.0000) (par=0.0000)
  Step 30650: loss=0.0944 (emo=0.0220) (lan=0.0000) (par=0.0000)
  Step 30700: loss=0.1332 (emo=0.0085) (lan=0.0000) (par=0.0000)
  Step 30750: loss=0.0984 (emo=0.0117) (lan=0.0000) (par=0.0000)
  Step 30800: loss=0.1983 (emo=0.0000) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 30850: loss=0.2083 (emo=0.0049) (lan=0.0000) (par=0.0000)
  Step 30900: loss=0.2155 (emo=0.0087) (lan=0.0000) (par=0.0001)
  Step 30950: loss=0.1099 (emo=0.0093) (lan=0.0000) (par=0.0000)
  Step 31000: loss=0.2416 (emo=0.4845) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_31000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_31000.npz
  Step 31050: loss=0.1350 (emo=0.0000) (lan=0.0000) (par=0.0171)
  Step 31100: loss=0.1633 (emo=0.0269) (lan=0.0000) (par=0.0000)
  Step 31150: loss=0.1795 (emo=0.0000) (lan=0.0000) (par=0.0006)
  Step 31200: loss=0.0624 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 31250: loss=0.1110 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 31300: loss=0.1816 (emo=0.2397) (lan=0.0000) (par=0.0000)
  Step 31350: loss=0.1229 (emo=0.0007) (lan=0.0000) (par=0.0000)
  Step 31400: loss=0.1950 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 31450: loss=0.2470 (emo=0.2790) (lan=0.0000) (par=0.0000)
  Step 31500: loss=0.2212 (emo=0.2276) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_31500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_31500.npz
  Step 31550: loss=0.2480 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 31600: loss=0.1441 (emo=0.7886) (lan=0.0000) (par=0.0000)
  Step 31650: loss=0.1224 (emo=0.0022) (lan=0.0000) (par=0.0000)
  Step 31700: loss=0.1114 (emo=0.0146) (lan=0.0000) (par=0.0000)
  Step 31750: loss=0.1762 (emo=0.0722) (lan=0.0000) (par=0.0002)
  Step 31800: loss=0.1362 (emo=0.0028) (lan=0.0000) (par=0.0000)
  Step 31850: loss=0.1129 (emo=0.0049) (lan=0.0000) (par=0.0000)
  Step 31900: loss=0.1183 (emo=0.0389) (lan=0.0000) (par=0.0007)
  Step 31950: loss=0.1090 (emo=0.3892) (lan=0.0000) (par=0.0000)
  Step 32000: loss=0.1370 (emo=0.0005) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_32000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_32000.npz
  Step 32050: loss=0.2335 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 32100: loss=0.1578 (emo=0.0098) (lan=0.0000) (par=0.0000)
  Step 32150: loss=0.1633 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 32200: loss=0.1903 (emo=0.0210) (lan=0.0000) (par=0.0000)
  Step 32250: loss=0.2978 (emo=0.0113) (lan=0.0000) (par=0.0000)
  Step 32300: loss=0.1847 (emo=0.0087) (lan=0.0000) (par=0.0000)
  Step 32350: loss=0.1766 (emo=0.1560) (lan=0.0000) (par=0.0000)
  Step 32400: loss=0.2940 (emo=0.2901) (lan=0.0000) (par=0.0000)
  Step 32450: loss=0.0940 (emo=0.0904) (lan=0.0000) (par=0.0000)
  Step 32500: loss=0.1244 (emo=0.3886) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_32500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_32500.npz
  Step 32550: loss=0.0811 (emo=0.0134) (lan=0.0000) (par=0.0000)
  Step 32600: loss=0.1109 (emo=0.0046) (lan=0.0000) (par=0.0000)
  Step 32650: loss=0.2089 (emo=0.0393) (lan=0.0000) (par=0.0000)
  Step 32700: loss=0.2614 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 32750: loss=0.1979 (emo=0.1357) (lan=0.0000) (par=0.0000)
  Step 32800: loss=0.1905 (emo=0.2400) (lan=0.0000) (par=0.0000)
  Step 32850: loss=0.1662 (emo=0.0390) (lan=0.0000) (par=0.0000)
  Step 32900: loss=0.3254 (emo=0.5472) (lan=0.0000) (par=0.0000)
  Step 32950: loss=0.2019 (emo=0.0156) (lan=0.0000) (par=0.0000)
  Step 33000: loss=0.2244 (emo=0.2773) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_33000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_33000.npz
  Step 33050: loss=0.1920 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 33100: loss=0.2353 (emo=0.0000) (lan=0.0000) (par=0.0003)
  Step 33150: loss=0.2488 (emo=0.0134) (lan=0.0000) (par=0.0000)
  Step 33200: loss=0.2312 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 33250: loss=0.1683 (emo=0.0086) (lan=0.0000) (par=0.0000)
  Step 33300: loss=0.1247 (emo=0.0011) (lan=0.0000) (par=0.0000)
  Step 33350: loss=0.2374 (emo=0.0043) (lan=0.0000) (par=0.0000)
  Step 33400: loss=0.1588 (emo=0.2214) (lan=0.0000) (par=0.0096)
  Step 33450: loss=0.3271 (emo=0.0149) (lan=0.0000) (par=0.0000)
  Step 33500: loss=0.1871 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_33500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_33500.npz
  Step 33550: loss=0.2320 (emo=0.0820) (lan=0.0000) (par=0.0000)
  Step 33600: loss=0.1759 (emo=0.0239) (lan=0.0000) (par=0.0000)
  Step 33650: loss=0.1330 (emo=0.0319) (lan=0.0000) (par=0.0000)
  Step 33700: loss=0.0914 (emo=0.0287) (lan=0.0000) (par=0.0000)
  Step 33750: loss=0.1448 (emo=0.0961) (lan=0.0000) (par=0.0001)
  Step 33800: loss=0.1598 (emo=0.0008) (lan=0.0000) (par=0.0000)
  Step 33850: loss=0.0939 (emo=0.0009) (lan=0.0000) (par=0.1886)
  Step 33900: loss=0.1358 (emo=0.0022) (lan=0.0000) (par=0.0000)
  Step 33950: loss=0.1291 (emo=0.0000) (lan=0.0000) (par=0.0005)
  Step 34000: loss=0.2400 (emo=0.0031) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_34000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_34000.npz
  Step 34050: loss=0.2636 (emo=0.0549) (lan=0.0000) (par=0.0000)
  Step 34100: loss=0.2881 (emo=0.0186) (lan=0.0000) (par=0.0001)
  Step 34150: loss=0.1720 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 34200: loss=0.2353 (emo=0.0897) (lan=0.0000) (par=0.0000)
  Step 34250: loss=0.1903 (emo=0.0023) (lan=0.0000) (par=0.0005)
  Step 34300: loss=0.1738 (emo=0.3680) (lan=0.0000) (par=0.0000)
  Step 34350: loss=0.1031 (emo=0.0004) (lan=0.0000) (par=0.0000)
  Step 34400: loss=0.1181 (emo=0.0209) (lan=0.0000) (par=0.0000)
  Step 34450: loss=0.1508 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 34500: loss=0.1116 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_34500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_34500.npz
Epoch 7/10: loss=0.1685
  Val loss: 0.5449
    emotion_acc: 92.07%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/best.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/best.npz
  New best model! (emotion_acc=92.07%)

Starting epoch 8/10
  Step 34550: loss=0.0229 (emo=0.0111) (lan=0.0000) (par=0.0000)
  Step 34600: loss=0.0823 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 34650: loss=0.0655 (emo=0.0118) (lan=0.0000) (par=0.0000)
  Step 34700: loss=0.0808 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 34750: loss=0.1603 (emo=0.0592) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 34800: loss=0.0906 (emo=0.0041) (lan=0.0000) (par=0.0000)
  Step 34850: loss=0.1157 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 34900: loss=0.1097 (emo=0.0869) (lan=0.0000) (par=0.0007)
  Step 34950: loss=0.1012 (emo=0.0081) (lan=0.0000) (par=0.0000)
  Step 35000: loss=0.0904 (emo=0.0070) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_35000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_35000.npz
  Step 35050: loss=0.1220 (emo=0.1158) (lan=0.0000) (par=0.0033)
  Step 35100: loss=0.1840 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 35150: loss=0.1134 (emo=0.0179) (lan=0.0000) (par=0.0000)
  Step 35200: loss=0.1186 (emo=0.0026) (lan=0.0000) (par=0.0000)
  Step 35250: loss=0.0869 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 35300: loss=0.1102 (emo=0.0981) (lan=0.0000) (par=0.0000)
  Step 35350: loss=0.0852 (emo=0.0105) (lan=0.0000) (par=0.0000)
  Step 35400: loss=0.0939 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 35450: loss=0.0732 (emo=0.0204) (lan=0.0000) (par=0.0000)
  Step 35500: loss=0.1680 (emo=0.5495) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_35500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_35500.npz
  Step 35550: loss=0.0628 (emo=0.0178) (lan=0.0000) (par=0.0000)
  Step 35600: loss=0.1191 (emo=0.0083) (lan=0.0000) (par=0.0000)
  Step 35650: loss=0.1095 (emo=0.0892) (lan=0.0000) (par=0.0000)
  Step 35700: loss=0.1035 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 35750: loss=0.0473 (emo=0.0245) (lan=0.0000) (par=0.0000)
  Step 35800: loss=0.1035 (emo=0.2613) (lan=0.0000) (par=0.0000)
  Step 35850: loss=0.0780 (emo=0.0006) (lan=0.0000) (par=0.0000)
  Step 35900: loss=0.2141 (emo=0.0655) (lan=0.0000) (par=0.0000)
  Step 35950: loss=0.1117 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 36000: loss=0.1985 (emo=0.0010) (lan=0.0000) (par=0.0059)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_36000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_36000.npz
  Step 36050: loss=0.1620 (emo=0.0906) (lan=0.0000) (par=0.1098)
  Step 36100: loss=0.2026 (emo=0.0005) (lan=0.0000) (par=0.0000)
  Step 36150: loss=0.0831 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 36200: loss=0.0874 (emo=0.0001) (lan=0.0000) (par=0.0002)
  Step 36250: loss=0.0927 (emo=0.0004) (lan=0.0000) (par=0.0000)
  Step 36300: loss=0.0738 (emo=0.0380) (lan=0.0000) (par=0.0000)
  Step 36350: loss=0.1713 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 36400: loss=0.2116 (emo=0.0031) (lan=0.0000) (par=0.0000)
  Step 36450: loss=0.0870 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 36500: loss=0.1351 (emo=0.0205) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_36500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_36500.npz
  Step 36550: loss=0.1793 (emo=0.0023) (lan=0.0000) (par=0.0000)
  Step 36600: loss=0.0799 (emo=0.2601) (lan=0.0000) (par=0.0000)
  Step 36650: loss=0.0850 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 36700: loss=0.1590 (emo=0.0313) (lan=0.0000) (par=0.0000)
  Step 36750: loss=0.0890 (emo=0.0031) (lan=0.0000) (par=0.0000)
  Step 36800: loss=0.1299 (emo=0.0174) (lan=0.0000) (par=0.0001)
  Step 36850: loss=0.1768 (emo=0.0565) (lan=0.0000) (par=0.0000)
  Step 36900: loss=0.0931 (emo=0.0207) (lan=0.0000) (par=0.0000)
  Step 36950: loss=0.2954 (emo=0.0735) (lan=0.0000) (par=0.0000)
  Step 37000: loss=0.0771 (emo=0.0024) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_37000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_37000.npz
  Step 37050: loss=0.1168 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 37100: loss=0.0876 (emo=0.0038) (lan=0.0000) (par=0.0000)
  Step 37150: loss=0.1091 (emo=0.1672) (lan=0.0000) (par=0.0000)
  Step 37200: loss=0.1435 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 37250: loss=0.1001 (emo=0.0006) (lan=0.0000) (par=0.0000)
  Step 37300: loss=0.1211 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 37350: loss=0.1083 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 37400: loss=0.1420 (emo=0.0234) (lan=0.0000) (par=0.0000)
  Step 37450: loss=0.0794 (emo=0.0030) (lan=0.0000) (par=0.0000)
  Step 37500: loss=0.1764 (emo=0.2271) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_37500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_37500.npz
  Step 37550: loss=0.2119 (emo=0.0051) (lan=0.0000) (par=0.0000)
  Step 37600: loss=0.0820 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 37650: loss=0.0966 (emo=0.0013) (lan=0.0000) (par=0.0001)
  Step 37700: loss=0.1191 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 37750: loss=0.2114 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 37800: loss=0.1205 (emo=0.0109) (lan=0.0000) (par=0.0000)
  Step 37850: loss=0.1258 (emo=0.0000) (lan=0.0000) (par=0.0084)
  Step 37900: loss=0.1778 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 37950: loss=0.1001 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 38000: loss=0.2774 (emo=0.0148) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_38000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_38000.npz
  Step 38050: loss=0.1716 (emo=0.0322) (lan=0.0000) (par=0.0001)
  Step 38100: loss=0.1222 (emo=0.1008) (lan=0.0000) (par=0.0000)
  Step 38150: loss=0.1897 (emo=1.5653) (lan=0.0000) (par=0.0000)
  Step 38200: loss=0.1729 (emo=0.0204) (lan=0.0000) (par=0.0000)
  Step 38250: loss=0.1034 (emo=0.0178) (lan=0.0000) (par=0.0000)
  Step 38300: loss=0.2176 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 38350: loss=0.1697 (emo=0.2313) (lan=0.0000) (par=0.0000)
  Step 38400: loss=0.0484 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 38450: loss=0.1796 (emo=0.0000) (lan=0.0000) (par=0.0266)
  Step 38500: loss=0.0899 (emo=0.0152) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_38500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_38500.npz
  Step 38550: loss=0.1188 (emo=0.0017) (lan=0.0000) (par=0.0000)
  Step 38600: loss=0.1236 (emo=0.0352) (lan=0.0000) (par=0.0000)
  Step 38650: loss=0.1140 (emo=0.0054) (lan=0.0000) (par=0.0001)
  Step 38700: loss=0.1290 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 38750: loss=0.1774 (emo=0.0032) (lan=0.0000) (par=0.0007)
  Step 38800: loss=0.2020 (emo=0.0027) (lan=0.0000) (par=0.0000)
  Step 38850: loss=0.1383 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 38900: loss=0.0704 (emo=0.0052) (lan=0.0000) (par=0.0000)
  Step 38950: loss=0.2719 (emo=0.0300) (lan=0.0000) (par=0.0000)
  Step 39000: loss=0.1345 (emo=0.0034) (lan=0.0000) (par=0.0001)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_39000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_39000.npz
  Step 39050: loss=0.0987 (emo=0.0006) (lan=0.0000) (par=0.0002)
  Step 39100: loss=0.1572 (emo=0.0341) (lan=0.0000) (par=0.0063)
  Step 39150: loss=0.0952 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 39200: loss=0.2413 (emo=0.0043) (lan=0.0000) (par=0.0000)
  Step 39250: loss=0.0720 (emo=0.0102) (lan=0.0000) (par=0.0000)
  Step 39300: loss=0.1817 (emo=0.0502) (lan=0.0000) (par=0.0000)
  Step 39350: loss=0.1481 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 39400: loss=0.0785 (emo=0.0069) (lan=0.0000) (par=0.0000)
  Step 39450: loss=0.0729 (emo=0.0000) (lan=0.0000) (par=0.0000)
Epoch 8/10: loss=0.1292
  Val loss: 0.6308
    emotion_acc: 91.15%
    language_acc: 100.00%

Starting epoch 9/10
  Step 39500: loss=0.1602 (emo=0.4028) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_39500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_39500.npz
  Step 39550: loss=0.0741 (emo=0.0000) (lan=0.0000) (par=0.0003)
  Step 39600: loss=0.0731 (emo=0.0343) (lan=0.0000) (par=0.0001)
  Step 39650: loss=0.0356 (emo=0.0760) (lan=0.0000) (par=0.0000)
  Step 39700: loss=0.0563 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 39750: loss=0.0756 (emo=0.0011) (lan=0.0000) (par=0.0000)
  Step 39800: loss=0.0652 (emo=0.0019) (lan=0.0000) (par=0.0000)
  Step 39850: loss=0.0422 (emo=0.0209) (lan=0.0000) (par=0.0001)
  Step 39900: loss=0.0446 (emo=0.0015) (lan=0.0000) (par=0.0000)
  Step 39950: loss=0.0433 (emo=0.0158) (lan=0.0000) (par=0.0000)
  Step 40000: loss=0.0442 (emo=0.0221) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_40000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_40000.npz
  Step 40050: loss=0.0875 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 40100: loss=0.1051 (emo=0.0021) (lan=0.0000) (par=0.0000)
  Step 40150: loss=0.1060 (emo=0.0644) (lan=0.0000) (par=0.0000)
  Step 40200: loss=0.0538 (emo=0.0401) (lan=0.0000) (par=0.0000)
  Step 40250: loss=0.1161 (emo=0.0072) (lan=0.0000) (par=0.0000)
  Step 40300: loss=0.0578 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 40350: loss=0.0353 (emo=0.0016) (lan=0.0000) (par=0.0000)
  Step 40400: loss=0.0670 (emo=0.0022) (lan=0.0000) (par=0.0003)
  Step 40450: loss=0.0516 (emo=0.0019) (lan=0.0000) (par=0.0000)
  Step 40500: loss=0.1375 (emo=0.0025) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_40500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_40500.npz
  Step 40550: loss=0.0972 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 40600: loss=0.1189 (emo=0.0010) (lan=0.0000) (par=0.0000)
  Step 40650: loss=0.0957 (emo=0.0132) (lan=0.0000) (par=0.0000)
  Step 40700: loss=0.1379 (emo=0.0050) (lan=0.0000) (par=0.0000)
  Step 40750: loss=0.0595 (emo=0.2230) (lan=0.0000) (par=0.0000)
  Step 40800: loss=0.0787 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 40850: loss=0.0833 (emo=0.0006) (lan=0.0000) (par=0.0000)
  Step 40900: loss=0.0641 (emo=0.0009) (lan=0.0000) (par=0.0003)
  Step 40950: loss=0.0658 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 41000: loss=0.1787 (emo=0.0002) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_41000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_41000.npz
  Step 41050: loss=0.0659 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 41100: loss=0.2569 (emo=0.0074) (lan=0.0000) (par=0.0063)
  Step 41150: loss=0.1391 (emo=0.0139) (lan=0.0000) (par=0.0000)
  Step 41200: loss=0.1204 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 41250: loss=0.0812 (emo=0.0021) (lan=0.0000) (par=0.0000)
  Step 41300: loss=0.1736 (emo=0.0045) (lan=0.0000) (par=0.0000)
  Step 41350: loss=0.1010 (emo=0.0286) (lan=0.0000) (par=0.0000)
  Step 41400: loss=0.1748 (emo=0.0142) (lan=0.0000) (par=0.0000)
  Step 41450: loss=0.1757 (emo=0.0002) (lan=0.0000) (par=0.0000)
  Step 41500: loss=0.1707 (emo=0.0149) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_41500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_41500.npz
  Step 41550: loss=0.0662 (emo=0.0555) (lan=0.0000) (par=0.0000)
  Step 41600: loss=0.0628 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 41650: loss=0.1496 (emo=0.1614) (lan=0.0000) (par=0.0000)
  Step 41700: loss=0.0979 (emo=0.0318) (lan=0.0000) (par=0.0000)
  Step 41750: loss=0.1541 (emo=0.0106) (lan=0.0000) (par=0.0000)
  Step 41800: loss=0.1028 (emo=0.0025) (lan=0.0000) (par=0.0000)
  Step 41850: loss=0.1786 (emo=0.0040) (lan=0.0000) (par=0.0000)
  Step 41900: loss=0.1498 (emo=0.0032) (lan=0.0000) (par=0.0000)
  Step 41950: loss=0.0992 (emo=0.0213) (lan=0.0000) (par=0.0000)
  Step 42000: loss=0.0800 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_42000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_42000.npz
  Step 42050: loss=0.0882 (emo=0.0205) (lan=0.0000) (par=0.0001)
  Step 42100: loss=0.0877 (emo=0.0027) (lan=0.0000) (par=0.0001)
  Step 42150: loss=0.0697 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 42200: loss=0.0609 (emo=0.0884) (lan=0.0000) (par=0.0000)
  Step 42250: loss=0.0553 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 42300: loss=0.1072 (emo=0.0166) (lan=0.0000) (par=0.0000)
  Step 42350: loss=0.2473 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 42400: loss=0.1395 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 42450: loss=0.0799 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 42500: loss=0.1185 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_42500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_42500.npz
  Step 42550: loss=0.1794 (emo=0.0271) (lan=0.0000) (par=0.0000)
  Step 42600: loss=0.1405 (emo=0.1023) (lan=0.0000) (par=0.0000)
  Step 42650: loss=0.0751 (emo=0.0218) (lan=0.0000) (par=0.0000)
  Step 42700: loss=0.0678 (emo=0.0029) (lan=0.0000) (par=0.0000)
  Step 42750: loss=0.1323 (emo=0.0022) (lan=0.0000) (par=0.0000)
  Step 42800: loss=0.0755 (emo=0.0277) (lan=0.0000) (par=0.0000)
  Step 42850: loss=0.1370 (emo=0.0099) (lan=0.0000) (par=0.0000)
  Step 42900: loss=0.0593 (emo=0.0052) (lan=0.0000) (par=0.0047)
  Step 42950: loss=0.1713 (emo=0.0004) (lan=0.0000) (par=0.0000)
  Step 43000: loss=0.0697 (emo=0.0045) (lan=0.0000) (par=0.0045)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_43000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_43000.npz
  Step 43050: loss=0.1171 (emo=0.2363) (lan=0.0000) (par=0.0000)
  Step 43100: loss=0.0714 (emo=0.1826) (lan=0.0000) (par=0.0000)
  Step 43150: loss=0.1694 (emo=0.0174) (lan=0.0000) (par=0.0022)
  Step 43200: loss=0.1306 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 43250: loss=0.1353 (emo=0.0081) (lan=0.0000) (par=0.0000)
  Step 43300: loss=0.1489 (emo=0.0781) (lan=0.0000) (par=0.0000)
  Step 43350: loss=0.0661 (emo=0.0012) (lan=0.0000) (par=0.0000)
  Step 43400: loss=0.0653 (emo=0.0172) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 43450: loss=0.0591 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 43500: loss=0.0959 (emo=0.0037) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_43500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_43500.npz
  Step 43550: loss=0.0962 (emo=0.0106) (lan=0.0000) (par=0.0000)
  Step 43600: loss=0.0510 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 43650: loss=0.0688 (emo=0.0024) (lan=0.0000) (par=0.0000)
  Step 43700: loss=0.0772 (emo=0.6708) (lan=0.0000) (par=0.0000)
  Step 43750: loss=0.1505 (emo=0.0275) (lan=0.0000) (par=0.0000)
  Step 43800: loss=0.0843 (emo=0.0012) (lan=0.0000) (par=0.0000)
  Step 43850: loss=0.0970 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 43900: loss=0.0265 (emo=0.0574) (lan=0.0000) (par=0.0000)
  Step 43950: loss=0.0728 (emo=0.0019) (lan=0.0000) (par=0.0011)
  Step 44000: loss=0.1497 (emo=0.0002) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_44000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_44000.npz
  Step 44050: loss=0.0851 (emo=0.0293) (lan=0.0000) (par=0.0000)
  Step 44100: loss=0.0565 (emo=0.0055) (lan=0.0000) (par=0.0001)
  Step 44150: loss=0.0791 (emo=0.1477) (lan=0.0000) (par=0.0000)
  Step 44200: loss=0.1842 (emo=0.0114) (lan=0.0000) (par=0.0005)
  Step 44250: loss=0.1908 (emo=0.0020) (lan=0.0000) (par=0.0000)
  Step 44300: loss=0.1554 (emo=0.0014) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/paralinguistics/silence/silence_00101.wav: No data left in file
  Step 44350: loss=0.2029 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 44400: loss=0.1781 (emo=0.0006) (lan=0.0000) (par=0.0000)
Epoch 9/10: loss=0.1042
  Val loss: 0.6839
    emotion_acc: 91.15%
    language_acc: 100.00%

Starting epoch 10/10
  Step 44450: loss=0.0441 (emo=0.0163) (lan=0.0000) (par=0.0000)
  Step 44500: loss=0.1216 (emo=0.0049) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_44500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_44500.npz
  Step 44550: loss=0.0382 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 44600: loss=0.1070 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 44650: loss=0.0531 (emo=0.0004) (lan=0.0000) (par=0.0000)
  Step 44700: loss=0.0446 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 44750: loss=0.0799 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 44800: loss=0.0214 (emo=0.0006) (lan=0.0000) (par=0.0000)
  Step 44850: loss=0.0555 (emo=0.0020) (lan=0.0000) (par=0.0000)
  Step 44900: loss=0.0749 (emo=0.0416) (lan=0.0000) (par=0.0000)
  Step 44950: loss=0.0729 (emo=0.0011) (lan=0.0000) (par=0.0000)
  Step 45000: loss=0.1277 (emo=0.0005) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_45000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_45000.npz
  Step 45050: loss=0.0867 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 45100: loss=0.0769 (emo=0.0020) (lan=0.0000) (par=0.0004)
  Step 45150: loss=0.0615 (emo=0.0153) (lan=0.0000) (par=0.0000)
  Step 45200: loss=0.0627 (emo=0.0009) (lan=0.0000) (par=0.0000)
  Step 45250: loss=0.0440 (emo=0.0013) (lan=0.0000) (par=0.0000)
  Step 45300: loss=0.1391 (emo=0.0003) (lan=0.0000) (par=0.0000)
  Step 45350: loss=0.0714 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 45400: loss=0.1309 (emo=0.0335) (lan=0.0000) (par=0.0000)
  Step 45450: loss=0.1030 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 45500: loss=0.0746 (emo=0.0283) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_45500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_45500.npz
  Step 45550: loss=0.0431 (emo=0.0020) (lan=0.0000) (par=0.0000)
  Step 45600: loss=0.1679 (emo=0.4006) (lan=0.0000) (par=0.0000)
  Step 45650: loss=0.0610 (emo=0.0033) (lan=0.0000) (par=0.0002)
  Step 45700: loss=0.0892 (emo=0.0037) (lan=0.0000) (par=0.0002)
  Step 45750: loss=0.0173 (emo=0.0031) (lan=0.0000) (par=0.0000)
  Step 45800: loss=0.0875 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 45850: loss=0.0892 (emo=0.0018) (lan=0.0000) (par=0.0000)
  Step 45900: loss=0.1244 (emo=0.0000) (lan=0.0000) (par=0.0008)
  Step 45950: loss=0.0255 (emo=0.0323) (lan=0.0000) (par=0.0000)
  Step 46000: loss=0.0730 (emo=0.0004) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_46000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_46000.npz
  Step 46050: loss=0.0589 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 46100: loss=0.0565 (emo=0.0000) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/paralinguistics/silence/silence_00101.wav: No data left in file
  Step 46150: loss=0.0376 (emo=0.0059) (lan=0.0000) (par=0.0000)
  Step 46200: loss=0.0685 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 46250: loss=0.0891 (emo=0.0132) (lan=0.0000) (par=0.0000)
  Step 46300: loss=0.1291 (emo=0.0007) (lan=0.0000) (par=0.0000)
Warning: Failed to load encoder cache for /Users/ayates/model_mlx_migration/data/singing/ravdess_emotions_hf/test_0000_3.wav: No data left in file
  Step 46350: loss=0.0633 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 46400: loss=0.0984 (emo=0.0001) (lan=0.0000) (par=0.0000)
  Step 46450: loss=0.0207 (emo=0.0049) (lan=0.0000) (par=0.0000)
  Step 46500: loss=0.1307 (emo=0.0247) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_46500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_46500.npz
  Step 46550: loss=0.1882 (emo=0.0061) (lan=0.0000) (par=0.0000)
  Step 46600: loss=0.0779 (emo=0.0180) (lan=0.0000) (par=0.0000)
  Step 46650: loss=0.0629 (emo=0.0269) (lan=0.0000) (par=0.0000)
  Step 46700: loss=0.0808 (emo=0.0141) (lan=0.0000) (par=0.0000)
  Step 46750: loss=0.1515 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 46800: loss=0.1032 (emo=0.0001) (lan=0.0000) (par=0.0006)
  Step 46850: loss=0.0541 (emo=0.0266) (lan=0.0000) (par=0.0000)
  Step 46900: loss=0.0620 (emo=0.0450) (lan=0.0000) (par=0.0000)
  Step 46950: loss=0.0762 (emo=0.0205) (lan=0.0000) (par=0.0000)
  Step 47000: loss=0.0892 (emo=0.0001) (lan=0.0000) (par=0.0051)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_47000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_47000.npz
  Step 47050: loss=0.1527 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 47100: loss=0.1086 (emo=0.0115) (lan=0.0000) (par=0.0000)
  Step 47150: loss=0.0534 (emo=0.0049) (lan=0.0000) (par=0.0000)
  Step 47200: loss=0.1258 (emo=0.0578) (lan=0.0000) (par=0.1054)
  Step 47250: loss=0.0831 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 47300: loss=0.0993 (emo=0.0000) (lan=0.0000) (par=0.0018)
  Step 47350: loss=0.1351 (emo=0.0012) (lan=0.0000) (par=0.0000)
  Step 47400: loss=0.1250 (emo=0.1056) (lan=0.0000) (par=0.0000)
  Step 47450: loss=0.0611 (emo=0.0012) (lan=0.0000) (par=0.0003)
  Step 47500: loss=0.0860 (emo=0.0097) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_47500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_47500.npz
  Step 47550: loss=0.0542 (emo=0.0364) (lan=0.0000) (par=0.0000)
  Step 47600: loss=0.1466 (emo=0.0031) (lan=0.0000) (par=0.0000)
  Step 47650: loss=0.1013 (emo=0.0656) (lan=0.0000) (par=0.0000)
  Step 47700: loss=0.0879 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 47750: loss=0.0768 (emo=0.0000) (lan=0.0000) (par=0.0149)
  Step 47800: loss=0.1238 (emo=0.0007) (lan=0.0000) (par=0.0000)
  Step 47850: loss=0.1343 (emo=0.0017) (lan=0.0000) (par=0.0000)
  Step 47900: loss=0.0384 (emo=0.1239) (lan=0.0000) (par=0.0000)
  Step 47950: loss=0.0502 (emo=0.0062) (lan=0.0000) (par=0.0000)
  Step 48000: loss=0.0964 (emo=0.0084) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_48000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_48000.npz
  Step 48050: loss=0.0506 (emo=0.0114) (lan=0.0000) (par=0.0000)
  Step 48100: loss=0.0854 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 48150: loss=0.1591 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 48200: loss=0.0714 (emo=0.0002) (lan=0.0000) (par=0.0005)
  Step 48250: loss=0.0721 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 48300: loss=0.2296 (emo=0.0000) (lan=0.0000) (par=0.0041)
  Step 48350: loss=0.0910 (emo=0.0618) (lan=0.0000) (par=0.0000)
  Step 48400: loss=0.1643 (emo=0.0022) (lan=0.0000) (par=0.0008)
  Step 48450: loss=0.1008 (emo=0.0141) (lan=0.0000) (par=0.0000)
  Step 48500: loss=0.0389 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_48500.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_48500.npz
  Step 48550: loss=0.0354 (emo=0.0000) (lan=0.0000) (par=0.0001)
  Step 48600: loss=0.1334 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 48650: loss=0.1902 (emo=0.0411) (lan=0.0000) (par=0.0000)
  Step 48700: loss=0.0818 (emo=0.0004) (lan=0.0000) (par=0.0000)
  Step 48750: loss=0.1091 (emo=0.0032) (lan=0.0000) (par=0.0000)
  Step 48800: loss=0.0882 (emo=0.0002) (lan=0.0000) (par=0.0005)
  Step 48850: loss=0.0828 (emo=0.0074) (lan=0.0000) (par=0.0000)
  Step 48900: loss=0.0920 (emo=0.0429) (lan=0.0000) (par=0.0000)
  Step 48950: loss=0.0596 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 49000: loss=0.1357 (emo=0.0000) (lan=0.0000) (par=0.0000)
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/step_49000.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/step_49000.npz
  Step 49050: loss=0.0410 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 49100: loss=0.0400 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 49150: loss=0.0466 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 49200: loss=0.1343 (emo=0.0085) (lan=0.0000) (par=0.0000)
  Step 49250: loss=0.0697 (emo=0.0000) (lan=0.0000) (par=0.0000)
  Step 49300: loss=0.1441 (emo=0.0001) (lan=0.0000) (par=0.0000)
Epoch 10/10: loss=0.0885
  Val loss: 0.6789
    emotion_acc: 91.70%
    language_acc: 100.00%
Saved 419 trainable parameters to checkpoints/rich_decoder_v3_cached/final.npz
Saved checkpoint: checkpoints/rich_decoder_v3_cached/final.npz

Training complete!
Best emotion accuracy: 92.07%
