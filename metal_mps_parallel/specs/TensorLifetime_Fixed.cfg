\* TLC Configuration for TensorLifetime - FIXED CODE
\* This configuration should PASS all invariants (no use-after-free)

SPECIFICATION Spec

CONSTANTS
    NumThreads = 2
    NumTensors = 2
    CaptureByValue = TRUE  \* Fixed: __block captures owned copy with refcount

INVARIANTS
    TypeOK
    NoUseAfterFreeCrashes    \* EXPECTED TO PASS - fix prevents race
    OwnedTensorIsValid       \* Owned tensors cannot be GC'd
    RefcountConsistent       \* Refcount bookkeeping is correct

\* Expected outcome: TLC explores all states, no violations found.
\* The fix works because:
\* 1. StartLayerNorm increments refcount (CaptureByValue = TRUE)
\* 2. PythonGCFreeTensor sees refcount > 1, cannot free
\* 3. EncodeWithBuffer always sees valid MTLBuffer
\* 4. CompleteOperation decrements refcount after encoding done
