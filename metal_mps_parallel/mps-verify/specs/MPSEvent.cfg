\* TLC Configuration for MPSEvent
\* Run with: tlc MPSEvent.tla -config MPSEvent.cfg
\*
\* This verifies the callback lifetime safety patterns:
\*   - 32.107 fix: Callbacks check alive flag before accessing event members
\*   - 32.89 fix: reset() invalidates old callback state, creates new one
\*   - shared_ptr prevents use-after-free in callbacks
\*
\* Key fixes verified:
\*   - Destructor sets alive=false before waiting
\*   - Callbacks notify completion even when alive=false
\*   - Pool reuse doesn't cause callback cross-talk

\* Constants - small values for tractable model checking
\* NumCallbackStates >= NumEvents * 2 per the ASSUME
CONSTANTS
    NumEvents = 2
    NumThreads = 2
    NumCallbackStates = 4

\* Initial state
INIT Init

\* Next state relation
NEXT Next

\* Disable deadlock check - after pool shutdown, nothing more can happen (expected)
CHECK_DEADLOCK FALSE

\* Check these properties
INVARIANTS
    TypeOK
    Safety

\* Liveness (optional - can be slow with larger state spaces)
\* PROPERTIES
\*     EventuallyCallbacksComplete

\* State constraint to bound counters and make state space finite
CONSTRAINT StateConstraint
